<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>消耗品在庫一覧</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- ヘッダー -->
    <header class="header">
        <h1 id="pageTitle">消耗品在庫管理システム</h1>
        <p class="subtitle">PowerApps版をFlask + JavaScriptで再現</p>
    </header>

    <!-- ナビゲーションメニュー -->
    <nav class="nav-menu">
        <button class="nav-btn active" data-page="inventory">在庫一覧</button>
        <button class="nav-btn" data-page="register"> 消耗品管理</button>
        <button class="nav-btn" data-page="outbound">出庫</button>
        <button class="nav-btn" data-page="inbound">入庫</button>
        <button class="nav-btn" data-page="order">注文依頼</button>
        <button class="nav-btn" data-page="order-list">発注状態</button>
        <button class="nav-btn" data-page="dispatch">発注</button>
        <button class="nav-btn" data-page="suppliers">購入先管理</button>
        <button class="nav-btn" data-page="employees">👤 従業員管理</button>
    </nav>

    <!-- 在庫一覧ページ -->
    <div id="inventoryPage" class="page-content active">
    <!-- フィルターエリア -->
    <div class="filter-container">
        <h2>フィルター</h2>

        <div class="filter-group">
            <label for="qrCodeInput">QRコード検索</label>
            <input
                type="text"
                id="qrCodeInput"
                placeholder="QRコードを読み取る / 手入力"
                class="input-field"
            >
        </div>

        <div class="button-group">
            <button id="clearQrBtn" class="btn btn-secondary">
                削除 QRコードをクリア
            </button>
            <button id="scanQrBtn" class="btn btn-primary">
                QR QRスキャン
            </button>

            
        </div>

        <div class="filter-group">
            <label for="searchInput">品名検索</label>
            <input
                type="text"
                id="searchInput"
                placeholder="品名を検索できます"
                class="input-field"
            >
        </div>

        <div class="filter-row">
            <div class="filter-group">
                <label for="orderStatus">注文状態</label>
                <select id="orderStatus" class="input-field">
                    <option value="すべて">すべて</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="shortageStatus">欠品状態</label>
                <select id="shortageStatus" class="input-field">
                    <option value="すべて">すべて</option>
                </select>
            </div>
        </div>
    </div>

    <!-- 表示件数 -->
    <div class="count-info">
        <p id="countInfo">表示件数: 0 / 0</p>
    </div>

    <!-- 在庫一覧 -->
    <div id="inventoryList" class="inventory-list">
        <p class="loading">読み込み中...</p>
    </div>
    </div><!-- 在庫一覧ページ終了 -->

    <!-- registerPage -->
    <div id="registerPage" class="page-content">
        <div class="page-header">
            <h2>🧰 消耗品管理</h2>
            <p>新規登録と個別編集をタブで切り替え、在庫マスタを整理できます。</p>
        </div>

        <div class="subtab-group" id="registerSubtabs">
            <button class="subtab-btn active" data-detail-tab="create">🆕 新規登録</button>
            <button class="subtab-btn" data-detail-tab="edit">🛠 個別編集</button>
        </div>

        <div id="registerFormSection" class="form-container detail-tab-content" data-detail-tab-content="create">
            <h3 class="section-title">基本情報の入力</h3>

            <div class="filter-group">
                <label for="registerCode">コード *</label>
                <input type="text" id="registerCode" class="input-field" placeholder="例: TIP-12-EG-1" required>
            </div>
            <div class="filter-group">
                <label for="registerOrderCode">発注コード</label>
                <input type="text" id="registerOrderCode" class="input-field" placeholder="任意で設定できます">
            </div>
            <div class="filter-group">
                <label for="registerName">品名 *</label>
                <input type="text" id="registerName" class="input-field" placeholder="品名を入力" required>
            </div>
            <div class="filter-group">
                <label for="registerCategory">カテゴリ</label>
                <input type="text" id="registerCategory" class="input-field" placeholder="例: 事務用品">
            </div>
            <div class="filter-group">
                <label for="registerUnit">単位</label>
                <input type="text" id="registerUnit" class="input-field" placeholder="個 / 箱など" value="個">
            </div>
            <div class="filter-group">
                <label for="registerStockQty">在庫数</label>
                <input type="number" id="registerStockQty" class="input-field" placeholder="0" value="0" min="0">
            </div>
            <div class="filter-group">
                <label for="registerSafetyStock">安全在庫</label>
                <input type="number" id="registerSafetyStock" class="input-field" placeholder="0" value="0" min="0">
            </div>
            <div class="filter-group">
                <label for="registerUnitPrice">単価</label>
                <input type="number" id="registerUnitPrice" class="input-field" placeholder="0" value="0" min="0">
            </div>
            <div class="filter-group">
                <label for="registerOrderUnit">発注単位</label>
                <input type="number" id="registerOrderUnit" class="input-field" placeholder="1" value="1" min="1">
            </div>
            <div class="filter-group">
                <label for="registerSupplier">購入先</label>
                <select id="registerSupplier" class="input-field">
                    <option value="">-- 購入先を選択 --</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="registerStorageLocation">保管場所</label>
                <input type="text" id="registerStorageLocation" class="input-field" placeholder="倉庫・棚番号など">
            </div>
            <div class="filter-group image-upload-group">
                <label for="registerImage">商品画像</label>
                <input type="file" id="registerImage" class="input-field file-input" accept="image/*">
                <input type="hidden" id="registerImagePath">
                <div class="image-preview" id="registerImagePreviewBox" hidden>
                    <img src="" alt="商品画像プレビュー">
                </div>
                <div class="image-upload-actions">
                    <button type="button" class="btn btn-secondary" id="registerImageClearBtn">画像をクリア</button>
                </div>
                <small class="import-hint">PNG/JPG/GIF 最大 5MB まで</small>
            </div>
            <div class="filter-group">
                <label for="registerNote">備考</label>
                <textarea id="registerNote" class="input-field" rows="3" placeholder="任意"></textarea>
            </div>
            <button id="registerSubmitBtn" class="btn btn-primary primary-action" type="button">
                💾 新規登録する
            </button>

            <div class="import-section">
                <h3>CSVインポート</h3>
                <p class="import-note">テンプレートに沿って入力したファイルを読み込めます。</p>
                <input type="file" id="csvFileInput" class="input-field file-input" accept=".csv">
                <div class="import-actions">
                    <button id="csvImportBtn" class="btn btn-outline" type="button">CSVを読み込む</button>
                    <button id="csvTemplateDownloadBtn" class="btn btn-outline" type="button">テンプレートをダウンロード</button>
                </div>
                <small class="import-hint">必須列: コード / 品名。UTF-8 で保存してください。</small>
            </div>
        </div>

        <div id="editFormSection" class="detail-tab-content" data-detail-tab-content="edit" hidden>
            <div class="form-container">
                <h3 class="section-title">ギャラリーから選択</h3>
                <div class="filter-group">
                    <label for="editSearchCode">コード / 品名で検索</label>
                    <div class="input-with-button">
                        <input type="text" id="editSearchCode" class="input-field" placeholder="例: TIP または 手袋">
                        <button id="editLoadBtn" class="btn btn-secondary" type="button">ギャラリーを更新</button>
                    </div>
                    <small class="import-hint">キーワード未入力の場合は全件を表示します。</small>
                </div>
                <div id="editGalleryContainer" class="inventory-list compact">
                    <p class="loading">消耗品ギャラリーを読み込み中...</p>
                </div>
            </div>

            <div class="form-container">
                <h3 class="section-title">選択中のアイテム</h3>
                <div id="editItemPreview" class="quick-item-card" hidden></div>
                <div id="editFormFields" hidden>
                    <div class="filter-group">
                        <label for="editCode">コード *</label>
                        <input type="text" id="editCode" class="input-field" placeholder="コード" readonly style="background-color: #f5f5f5;">
                        <small class="import-hint">コードは変更できません</small>
                    </div>
                    <div class="filter-group">
                        <label for="editOrderCode">発注コード</label>
                        <input type="text" id="editOrderCode" class="input-field" placeholder="任意で設定できます">
                    </div>
                    <div class="filter-group">
                        <label for="editName">品名 *</label>
                        <input type="text" id="editName" class="input-field" placeholder="品名を入力" required>
                    </div>
                    <div class="filter-group">
                        <label for="editCategory">カテゴリ</label>
                        <input type="text" id="editCategory" class="input-field" placeholder="例: 事務用品">
                    </div>
                    <div class="filter-group">
                        <label for="editUnit">単位</label>
                        <input type="text" id="editUnit" class="input-field" placeholder="個 / 箱など">
                    </div>
                    <div class="filter-group">
                        <label for="editStockQty">在庫数</label>
                        <input type="number" id="editStockQty" class="input-field" placeholder="0" min="0">
                    </div>
                    <div class="filter-group">
                        <label for="editSafetyStock">安全在庫</label>
                        <input type="number" id="editSafetyStock" class="input-field" placeholder="0" min="0">
                    </div>
                    <div class="filter-group">
                        <label for="editUnitPrice">単価</label>
                        <input type="number" id="editUnitPrice" class="input-field" placeholder="0" min="0">
                    </div>
                    <div class="filter-group">
                        <label for="editOrderUnit">発注単位</label>
                        <input type="number" id="editOrderUnit" class="input-field" placeholder="1" min="1">
                    </div>
                    <div class="filter-group">
                        <label for="editSupplier">購入先</label>
                        <select id="editSupplier" class="input-field">
                            <option value="">-- 購入先を選択 --</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="editStorageLocation">保管場所</label>
                        <input type="text" id="editStorageLocation" class="input-field" placeholder="倉庫・棚番号など">
                    </div>
                    <div class="filter-group image-upload-group">
                        <label for="editImage">商品画像</label>
                        <input type="file" id="editImage" class="input-field file-input" accept="image/*">
                        <input type="hidden" id="editImagePath">
                        <div class="image-preview" id="editImagePreviewBox" hidden>
                            <img src="" alt="商品画像プレビュー">
                        </div>
                        <div class="image-upload-actions">
                            <button type="button" class="btn btn-secondary" id="editImageClearBtn">画像をクリア</button>
                        </div>
                        <small class="import-hint">PNG/JPG/GIF 最大 5MB まで</small>
                    </div>
                    <div class="filter-group">
                        <label for="editNote">備考</label>
                        <textarea id="editNote" class="input-field" rows="3" placeholder="任意"></textarea>
                    </div>
                    <button id="editSubmitBtn" class="btn btn-primary primary-action" type="button">
                        💾 内容を更新する
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- registerPage end -->

    <!-- 出庫ページ -->
    <div id="outboundPage" class="page-content">
        <div class="page-header">
            <h2>出庫</h2>
            <p>在庫から商品を出庫します</p>
        </div>

        <div class="form-container">
            <div class="filter-group">
                <label for="outboundQrCode">QRコード検索</label>
                <input type="text" id="outboundQrCode" class="input-field" placeholder="QRコードを読み取る">
                <button id="outboundScanBtn" class="btn btn-primary" style="margin-top: 10px; width: 100%;">
                    QR QRスキャン
                </button>
            </div>

            <div class="filter-group">
                <label for="outboundSearchText">品名検索</label>
                <input type="text" id="outboundSearchText" class="input-field" placeholder="品名で検索">
            </div>

            <div id="outboundItemInfo" class="item-info" style="display: none;">
                <h3>商品情報</h3>
                <div id="outboundItemDetails"></div>

                <div class="filter-group">
                    <label for="outboundQuantity">出庫数量</label>
                    <input type="number" id="outboundQuantity" class="input-field" min="1" placeholder="出庫数量を入力">
                </div>

                <div class="filter-group">
                    <label for="outboundPerson">出庫者</label>
                    <input type="text" id="outboundPerson" class="input-field" placeholder="出庫者名を入力">
                </div>

                <div class="filter-group">
                    <label for="outboundDepartment">部署</label>
                    <input type="text" id="outboundDepartment" class="input-field" placeholder="部署名を入力（任意）">
                </div>

                <div class="filter-group">
                    <label for="outboundNote">備考</label>
                    <textarea id="outboundNote" class="input-field" rows="3" placeholder="備考（任意）"></textarea>
                </div>

                <button id="submitOutbound" class="btn btn-primary" style="width: 100%;">
                     出庫を確定
                </button>
            </div>
        </div>
    </div>

    <!-- 入庫ページ -->
    <div id="inboundPage" class="page-content">
        <div class="page-header">
            <h2>入庫</h2>
            <p>商品を入庫します</p>
        </div>

        <div class="button-group" style="margin: 20px;">
            <button class="btn btn-primary" id="showManualInbound">注文 手動入庫</button>
            <button class="btn btn-secondary" id="showAutoInbound"> 自動依頼分</button>
        </div>

        <!-- 手動入庫 -->
        <div id="manualInboundForm" class="form-container">
            <h3>手動入庫</h3>

            <div class="filter-group">
                <label for="inboundQrCode">QRコード検索</label>
                <input type="text" id="inboundQrCode" class="input-field" placeholder="QRコードを読み取る">
                <button id="inboundScanBtn" class="btn btn-primary" style="margin-top: 10px; width: 100%;">
                    QR QRスキャン
                </button>
            </div>

            <div class="filter-group">
                <label for="inboundSearchText">品名検索</label>
                <input type="text" id="inboundSearchText" class="input-field" placeholder="品名で検索">
            </div>

            <div id="inboundItemInfo" class="item-info" style="display: none;">
                <h3>商品情報</h3>
                <div id="inboundItemDetails"></div>

                <div class="filter-group">
                    <label for="inboundQuantity">入庫数量</label>
                    <input type="number" id="inboundQuantity" class="input-field" min="1" placeholder="入庫数量を入力">
                </div>

                <div class="filter-group">
                    <label for="inboundPerson">入庫者</label>
                    <input type="text" id="inboundPerson" class="input-field" placeholder="入庫者名を入力">
                </div>

                <div class="filter-group">
                    <label for="inboundDepartment">部署</label>
                    <input type="text" id="inboundDepartment" class="input-field" placeholder="部署名を入力（任意）">
                </div>

                <button id="submitInbound" class="btn btn-primary" style="width: 100%;">
                     入庫を確定
                </button>
            </div>
        </div>

        <!-- 自動依頼分入庫 -->
        <div id="autoInboundList" class="form-container" style="display: none;">
            <h3>自動依頼分の入庫</h3>
            <div id="pendingOrdersList"></div>
        </div>
    </div>

    <!-- 注文依頼ページ -->
    <div id="orderPage" class="page-content">
        <div class="page-header">
            <h2>注文依頼</h2>
            <p>不足している商品の注文を依頼します</p>
        </div>

        <div class="form-container">
            <div class="filter-group">
                <label for="orderQrCode">QRコード検索</label>
                <input type="text" id="orderQrCode" class="input-field" placeholder="QRコードを読み取る">
                <button id="orderScanBtn" class="btn btn-primary" style="margin-top: 10px; width: 100%;">
                    QR QRスキャン
                </button>
            </div>

            <div id="orderItemInfo" class="item-info" style="display: none;">
                <h3>商品情報</h3>
                <div id="orderItemDetails"></div>

                <div class="filter-group">
                    <label for="orderQuantity">注文数量</label>
                    <input type="number" id="orderQuantity" class="input-field" min="1" placeholder="注文数量を入力">
                </div>

                <div class="filter-group">
                    <label for="orderDeadline">納期</label>
                    <select id="orderDeadline" class="input-field">
                        <option value="最短">最短</option>
                        <option value="通常">通常</option>
                        <option value="余裕あり">余裕あり</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="orderRequester">発注依頼者</label>
                    <input type="text" id="orderRequester" class="input-field" placeholder="依頼者名を入力">
                </div>

                <div class="filter-group">
                    <label for="orderNote">備考</label>
                    <textarea id="orderNote" class="input-field" rows="3" placeholder="備考（任意）"></textarea>
                </div>

                <button id="submitOrder" class="btn btn-primary" style="width: 100%;">
                     注文依頼を送信
                </button>
            </div>
        </div>
    </div>

    <!-- 発注状態リストページ -->
    <div id="orderListPage" class="page-content">
        <div class="page-header">
            <h2>一覧 発注依頼状態リスト</h2>
            <p>発注依頼の状況を確認します</p>
        </div>

        <div class="button-group" style="margin: 20px;">
            <button class="btn btn-primary" id="showManualOrders"> 人からの依頼</button>
            <button class="btn btn-secondary" id="showAutoOrders"> 自動依頼分</button>
        </div>

        <!-- 人からの依頼リスト -->
        <div id="manualOrdersList" class="list-container">
            <h3>人からの依頼</h3>
            <div id="manualOrdersContent"></div>
        </div>

        <!-- 自動依頼分リスト -->
        <div id="autoOrdersList" class="list-container" style="display: none;">
            <h3>自動依頼分（発注済み）</h3>
            <div id="autoOrdersContent"></div>
        </div>
    </div>

    <!-- 発注ページ -->
    <div id="dispatchPage" class="page-content">
        <div class="page-header">
            <h2>発注（PDF作成・メール送信）</h2>
            <p>注文書PDFを作成し、購入先にメール送信します</p>
        </div>

        <!-- ステップ1: 注文選択 -->
        <div class="form-container">
            <h3>ステップ1: 発注する注文を選択</h3>

            <!-- フィルター -->
            <div style="background: #f5f5f5; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                <h4 style="margin-top: 0;">検索 フィルター</h4>

                <div class="filter-row" style="margin-bottom: 12px;">
                    <div class="filter-group">
                        <label for="dispatchQrCode">QRコード検索</label>
                        <input type="text" id="dispatchQrCode" class="input-field"
                               placeholder="QRコードを入力">
                        <button id="dispatchScanBtn" class="btn btn-primary" style="margin-top: 10px; width: 100%;">
                            QR QRスキャン
                        </button>
                    </div>
                    <div class="filter-group">
                        <label for="dispatchSearchText">品名検索</label>
                        <input type="text" id="dispatchSearchText" class="input-field"
                               placeholder="品名を検索">
                    </div>
                </div>

                <div class="filter-row">
                    <div class="filter-group">
                        <label for="dispatchSupplier">購入先</label>
                        <select id="dispatchSupplier" class="input-field">
                            <option value="">すべて</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="dispatchOrderStatus">注文状態</label>
                        <select id="dispatchOrderStatus" class="input-field">
                            <option value="">すべて</option>
                            <option value="依頼中">依頼中</option>
                            <option value="発注済">発注済</option>
                            <option value="完了">完了</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="button-group" style="margin-bottom: 16px;">
                <button class="btn btn-primary" onclick="loadDispatchOrders()">
                    再読込 注文を読み込み
                </button>
                <button class="btn btn-secondary" onclick="selectAllOrders()">
                     すべて選択
                </button>
                <button class="btn btn-secondary" onclick="clearAllOrders()">
                     すべて解除
                </button>
            </div>

            <div id="dispatchOrdersList" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px; padding: 12px;">
                <p class="loading">注文を読み込むボタンをクリックしてください</p>
            </div>

            <div id="selectedOrdersSummary" style="margin-top: 16px; padding: 12px; background: #f5f5f5; border-radius: 8px; display: none;">
                <strong>選択中:</strong> <span id="selectedCount">0</span>件
                <span style="margin-left: 20px;"><strong>合計金額:</strong> <span id="selectedTotal">0</span></span>
            </div>
        </div>

        <!-- ステップ2: PDF設定 -->
        <div class="form-container" style="margin-top: 20px;">
            <h3>ステップ2: 注文書PDF設定</h3>

            <div class="filter-group">
                <label for="dispatchOrderNumber">注文書番号（任意）</label>
                <input type="text" id="dispatchOrderNumber" class="input-field"
                       placeholder="空欄の場合は自動採番されます">
            </div>

            <div class="filter-group">
                <label for="dispatchNotes">備考</label>
                <textarea id="dispatchNotes" class="input-field" rows="3"
                          placeholder="注文書に表示する備考（任意）"></textarea>
            </div>

            <button class="btn btn-secondary" onclick="generatePDFOnly()" style="width: 100%;">
                帳票 PDFのみ生成（ダウンロード）
            </button>
        </div>

        <!-- ステップ3: メール設定 -->
        <div class="form-container" style="margin-top: 20px;">
            <h3>ステップ3: メール送信設定</h3>

            <div class="filter-group">
                <label for="dispatchEmailTo">宛先（To） *</label>
                <input type="email" id="dispatchEmailTo" class="input-field"
                       placeholder="supplier@example.com" required>
                <small style="color: #666;">複数指定する場合はカンマ区切り</small>
            </div>

            <div class="filter-row">
                <div class="filter-group">
                    <label for="dispatchEmailCc">CC（任意）</label>
                    <input type="text" id="dispatchEmailCc" class="input-field"
                           placeholder="cc@example.com">
                </div>
                <div class="filter-group">
                    <label for="dispatchEmailBcc">BCC（任意）</label>
                    <input type="text" id="dispatchEmailBcc" class="input-field"
                           placeholder="bcc@example.com">
                </div>
            </div>

            <div class="filter-group">
                <label for="dispatchEmailSubject">件名 *</label>
                <input type="text" id="dispatchEmailSubject" class="input-field"
                       placeholder="【注文書送付】〇〇商事御中" required>
            </div>

            <div class="filter-group">
                <label for="dispatchEmailBody">本文 *</label>
                <textarea id="dispatchEmailBody" class="input-field" rows="6"
                          placeholder="お世話になっております。&#10;&#10;注文書をお送りいたします。&#10;ご確認のほどよろしくお願いいたします。" required></textarea>
            </div>

            <div class="filter-group">
                <label>
                    <input type="checkbox" id="dispatchSavePdf" checked>
                    PDFをサーバーに保存する
                </label>
            </div>

            <button class="btn btn-primary" onclick="dispatchOrdersWithEmail()"
                    style="width: 100%; font-size: 18px; padding: 16px;">
                発注 注文書を作成してメール送信
            </button>
        </div>

        <!-- 結果表示エリア -->
        <div id="dispatchResult" style="margin-top: 20px; display: none;">
            <div class="form-container">
                <h3> 発注完了</h3>
                <div id="dispatchResultContent"></div>
            </div>
        </div>
    </div>

    <!-- 購入先管理ページ -->
    <div id="suppliersPage" class="page-content">
        <div class="page-header">
            <h2>🏢 購入先管理</h2>
            <p>購入先の登録・編集・削除を行います</p>
        </div>

        <div class="subtab-group" id="suppliersSubtabs">
            <button class="subtab-btn active" data-detail-tab="list">📋 購入先一覧</button>
            <button class="subtab-btn" data-detail-tab="add">➕ 新規追加</button>
            <button class="subtab-btn" data-detail-tab="edit" style="display: none;">✏️ 編集</button>
        </div>

        <!-- 購入先一覧 -->
        <div id="suppliersListSection" class="detail-tab-content" data-detail-tab-content="list">
            <div class="form-container">
                <h3 class="section-title">登録済み購入先</h3>
                <div id="suppliersList" class="list-container">
                    <p class="loading">読み込み中...</p>
                </div>
            </div>
        </div>

        <!-- 新規追加 -->
        <div id="suppliersAddSection" class="detail-tab-content" data-detail-tab-content="add" hidden>
            <div class="form-container">
                <h3 class="section-title">購入先情報の入力</h3>

                <div class="filter-group">
                    <label for="supplierName">購入先名 *</label>
                    <input type="text" id="supplierName" class="input-field" placeholder="例: 株式会社サンプル商事" required>
                </div>

                <div class="filter-group">
                    <label for="supplierContact">連絡先</label>
                    <input type="text" id="supplierContact" class="input-field" placeholder="担当者名・電話番号など">
                </div>

                <div class="filter-group">
                    <label for="supplierEmail">メールアドレス</label>
                    <input type="email" id="supplierEmail" class="input-field" placeholder="order@example.com">
                </div>

                <div class="filter-group">
                    <label for="supplierAddress">住所</label>
                    <textarea id="supplierAddress" class="input-field" rows="3" placeholder="住所（任意）"></textarea>
                </div>

                <div class="filter-group">
                    <label for="supplierNote">備考</label>
                    <textarea id="supplierNote" class="input-field" rows="3" placeholder="備考（任意）"></textarea>
                </div>

                <button id="supplierSubmitBtn" class="btn btn-primary primary-action" type="button">
                    💾 購入先を登録する
                </button>
            </div>
        </div>

        <!-- 編集 -->
        <div id="suppliersEditSection" class="detail-tab-content" data-detail-tab-content="edit" hidden>
            <div class="form-container">
                <h3 class="section-title">購入先情報の編集</h3>

                <input type="hidden" id="editSupplierId">

                <div class="filter-group">
                    <label for="editSupplierName">購入先名 *</label>
                    <input type="text" id="editSupplierName" class="input-field" placeholder="例: 株式会社サンプル商事" required>
                </div>

                <div class="filter-group">
                    <label for="editSupplierContact">連絡先</label>
                    <input type="text" id="editSupplierContact" class="input-field" placeholder="担当者名・電話番号など">
                </div>

                <div class="filter-group">
                    <label for="editSupplierEmail">メールアドレス</label>
                    <input type="email" id="editSupplierEmail" class="input-field" placeholder="order@example.com">
                </div>

                <div class="filter-group">
                    <label for="editSupplierAddress">住所</label>
                    <textarea id="editSupplierAddress" class="input-field" rows="3" placeholder="住所（任意）"></textarea>
                </div>

                <div class="filter-group">
                    <label for="editSupplierNote">備考</label>
                    <textarea id="editSupplierNote" class="input-field" rows="3" placeholder="備考（任意）"></textarea>
                </div>

                <div style="display: flex; gap: 12px;">
                    <button id="supplierUpdateBtn" class="btn btn-primary primary-action" type="button">
                        💾 更新する
                    </button>
                    <button id="supplierCancelEditBtn" class="btn btn-outline" type="button">
                        ❌ キャンセル
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 従業員管理ページ -->
    <div id="employeesPage" class="page-content">
        <div class="page-header">
            <h2>従業員管理</h2>
            <p>従業員情報の登録・編集・削除</p>
        </div>

        <!-- サブタブ -->
        <div class="subtab-group" id="employeesSubtabs">
            <button class="subtab-btn active" data-detail-tab="list">👥 従業員一覧</button>
            <button class="subtab-btn" data-detail-tab="add">➕ 新規追加</button>
            <button class="subtab-btn" data-detail-tab="edit" style="display: none;">✏️ 編集</button>
        </div>

        <!-- 従業員一覧 -->
        <div id="employeesListSection" class="detail-tab-content" data-detail-tab-content="list">
            <div id="employeesList" class="form-container">
                <p class="loading">読み込み中...</p>
            </div>
        </div>

        <!-- 新規追加 -->
        <div id="employeesAddSection" class="detail-tab-content" data-detail-tab-content="add" hidden>
            <div class="form-container">
                <h3 class="section-title">新規従業員の登録</h3>

                <div class="filter-group">
                    <label for="employeeCode">従業員コード *</label>
                    <input type="text" id="employeeCode" class="input-field" placeholder="例: EMP001" required>
                </div>

                <div class="filter-group">
                    <label for="employeeName">氏名 *</label>
                    <input type="text" id="employeeName" class="input-field" placeholder="例: 山田太郎" required>
                </div>

                <div class="filter-group">
                    <label for="employeeDepartment">部署</label>
                    <input type="text" id="employeeDepartment" class="input-field" placeholder="例: 総務部">
                </div>

                <div class="filter-group">
                    <label for="employeeEmail">メールアドレス</label>
                    <input type="email" id="employeeEmail" class="input-field" placeholder="example@company.com">
                </div>

                <div class="filter-group">
                    <label for="employeePassword">パスワード</label>
                    <input type="password" id="employeePassword" class="input-field" placeholder="パスワード（任意）">
                </div>

                <div class="filter-group">
                    <label for="employeeRole">役職</label>
                    <select id="employeeRole" class="input-field">
                        <option value="一般">一般</option>
                        <option value="管理者">管理者</option>
                        <option value="マネージャー">マネージャー</option>
                    </select>
                </div>

                <button id="employeeSubmitBtn" class="btn btn-primary primary-action" type="button">
                    💾 従業員を登録する
                </button>

                <div class="import-section">
                    <h3>CSVインポート</h3>
                    <p class="import-note">テンプレートに沿って入力したファイルを読み込めます。</p>
                    <input type="file" id="employeeCsvFileInput" class="input-field file-input" accept=".csv">
                    <div class="import-actions">
                        <button id="employeeCsvImportBtn" class="btn btn-outline" type="button">CSVを読み込む</button>
                        <button id="employeeCsvTemplateDownloadBtn" class="btn btn-outline" type="button">テンプレートをダウンロード</button>
                    </div>
                    <small class="import-hint">必須列: コード / 氏名。UTF-8 で保存してください。</small>
                </div>
            </div>
        </div>

        <!-- 編集 -->
        <div id="employeesEditSection" class="detail-tab-content" data-detail-tab-content="edit" hidden>
            <div class="form-container">
                <h3 class="section-title">従業員情報の編集</h3>

                <input type="hidden" id="editEmployeeId">

                <div class="filter-group">
                    <label for="editEmployeeCode">従業員コード *</label>
                    <input type="text" id="editEmployeeCode" class="input-field" readonly style="background-color: #f5f5f5;">
                    <small class="import-hint">コードは変更できません</small>
                </div>

                <div class="filter-group">
                    <label for="editEmployeeName">氏名 *</label>
                    <input type="text" id="editEmployeeName" class="input-field" placeholder="例: 山田太郎" required>
                </div>

                <div class="filter-group">
                    <label for="editEmployeeDepartment">部署</label>
                    <input type="text" id="editEmployeeDepartment" class="input-field" placeholder="例: 総務部">
                </div>

                <div class="filter-group">
                    <label for="editEmployeeEmail">メールアドレス</label>
                    <input type="email" id="editEmployeeEmail" class="input-field" placeholder="example@company.com">
                </div>

                <div class="filter-group">
                    <label for="editEmployeePassword">パスワード</label>
                    <input type="password" id="editEmployeePassword" class="input-field" placeholder="変更する場合のみ入力">
                    <small class="import-hint">空欄の場合はパスワードを変更しません</small>
                </div>

                <div class="filter-group">
                    <label for="editEmployeeRole">役職</label>
                    <select id="editEmployeeRole" class="input-field">
                        <option value="一般">一般</option>
                        <option value="管理者">管理者</option>
                        <option value="マネージャー">マネージャー</option>
                    </select>
                </div>

                <div style="display: flex; gap: 12px;">
                    <button id="employeeUpdateBtn" class="btn btn-primary primary-action" type="button">
                        💾 更新する
                    </button>
                    <button id="employeeCancelEditBtn" class="btn btn-outline" type="button">
                        ❌ キャンセル
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- カメラモーダル -->
    <div id="cameraModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>QRコードスキャン</h2>
                <button id="closeModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <video id="cameraVideo" autoplay playsinline></video>
                <canvas id="cameraCanvas" style="display: none;"></canvas>
            </div>
            <div class="modal-footer">
                <button id="captureBtn" class="btn btn-primary">
                     撮影
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
