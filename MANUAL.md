# 消耗品在庫管理システム 操作マニュアル

バージョン: 1.0
最終更新日: 2025-11-15

---

## 目次

1. [システム概要](#システム概要)
2. [ログイン](#ログイン)
3. [在庫一覧](#在庫一覧)
4. [入出庫管理](#入出庫管理)
5. [注文管理](#注文管理)
6. [発注管理](#発注管理)
7. [マスタ管理](#マスタ管理)
8. [よくある質問](#よくある質問)

---

## システム概要

### システムの目的
消耗品の在庫を一元管理し、入出庫、発注、在庫状況の可視化を行うシステムです。

### 主な機能
- **在庫管理**: リアルタイムで在庫数を確認
- **入出庫管理**: QRコードを使った簡単な入出庫登録
- **注文管理**: 欠品時の発注依頼から注文書作成まで
- **発注管理**: 注文書の作成・送信・入庫管理
- **マスタ管理**: 消耗品、購入先、従業員、ユーザーの登録・編集

### 動作環境
- **ブラウザ**: Chrome、Edge、Firefox（最新版推奨）
- **アクセス**: `http://localhost:5000`（ローカル環境）

---

## ログイン

### ログイン手順
1. ブラウザでシステムのURLにアクセス
2. ログインIDとパスワードを入力
3. 「ログイン」ボタンをクリック

### 初回ログイン
- 管理者から発行されたIDとパスワードを使用
- 初回ログイン後、パスワード変更を推奨

---

## 在庫一覧

### 画面説明
在庫一覧画面では、登録されている全ての消耗品の在庫状況を確認できます。

### 主な機能

#### 1. 検索・フィルター
- **QRコード検索**: QRコードをスキャンして商品を検索
- **品名検索**: テキスト入力で商品名を検索
- **注文状態フィルター**: 未依頼、依頼中、発注済、入庫済みで絞り込み
- **欠品状態フィルター**: 在庫あり、要注意、欠品で絞り込み

#### 2. 在庫カード表示
各商品カードには以下の情報が表示されます：
- 商品画像
- 商品名・コード
- 発注コード
- カテゴリ
- 在庫数・安全在庫
- 購入先
- 欠品状態（色分け表示）
- 注文状態

#### 3. カラーコード
- **🟢 在庫あり**: 安全在庫以上
- **🟡 要注意**: 安全在庫未満
- **🔴 欠品**: 在庫0

#### 4. 注文詳細表示
- **依頼中の商品**: 依頼日、依頼数量、納期を表示
- **発注済の商品**: 注文日、注文数量、納期を表示（直近2件）
- **入庫済の商品**: 入庫日、数量、入庫者を表示（直近2件）

### 操作手順

#### QRコードで商品を検索
1. 「QRスキャン」ボタンをクリック
2. カメラでQRコードを読み取る
3. 該当商品が表示される

#### 品名で検索
1. 「品名検索」欄に商品名を入力
2. 該当商品が自動的に絞り込まれる

#### 出庫する
1. 商品カードの「📤 出庫」ボタンをクリック
2. 出庫画面に遷移（商品情報が自動入力）
3. 出庫数量と担当者情報を入力
4. 「出庫を確定」ボタンをクリック

#### 注文を依頼する
1. 商品カードの「🛒 注文依頼」ボタンをクリック
2. 注文依頼画面に遷移（商品情報が自動入力）
3. 数量、納期、依頼者情報を入力
4. 「発注依頼を送信」ボタンをクリック

---

## 入出庫管理

### 入出庫タブ
入出庫タブでは、入庫・出庫・履歴の3つのサブタブがあります。

---

### 📥 入庫

#### 個別入庫
手動で商品を入庫登録する機能です。

**操作手順:**
1. 「個別入庫」ボタンをクリック
2. QRコードまたは品名で商品を検索
3. 商品情報が表示されたら、以下を入力：
   - 入庫数量（必須）
   - 社員コード（入力すると氏名・部署が自動入力）
   - 入庫者名（必須）
   - 部署（任意）
   - 備考（任意）
4. 「✅ 入庫を確定」ボタンをクリック

**注意事項:**
- 入庫後、在庫数が自動的に増加します
- 商品の注文状態が「入庫済み」に更新されます

#### 注文書分入庫 ⚠️
発注した注文書から一括で入庫登録する機能です。

**⚠️ 重要な注意:**
- この機能は重複入庫のリスクがあります
- 既に個別入庫している商品を再度入庫すると、在庫が二重に計上されます
- **慎重に使用してください**

**操作手順:**
1. 「注文書分入庫（重複入庫のため、この機能を慎重に使ってください）」ボタンをクリック
2. 送信済みの注文書一覧が表示される
3. 入庫する注文書をクリック
4. 注文書の詳細が表示される
5. 以下を入力：
   - 社員コード（入力すると氏名・部署が自動入力）
   - 入庫者名（必須）
   - 部署（任意）
   - 備考（任意）
6. 「一括入庫を確定」ボタンをクリック
7. 確認メッセージが表示されるので、「OK」をクリック

**入庫後の処理:**
- 注文書に含まれる全商品の在庫数が増加
- 各商品の注文状態が「入庫済み」に更新
- 注文書のステータスが「入庫済み」に更新
- 注文書一覧から非表示になる

---

### 📤 出庫

商品を出庫する機能です。

**操作手順:**
1. QRコードまたは品名で商品を検索
2. 商品情報が表示されたら、以下を入力：
   - 出庫数量（必須）
   - 社員コード（入力すると氏名・部署が自動入力）
   - 出庫者名（必須）
   - 部署（任意）
   - 備考（任意）
3. 「📤 出庫を確定」ボタンをクリック

**注意事項:**
- 出庫後、在庫数が自動的に減少します
- 在庫不足の場合は警告が表示されます

---

### 📋 入出庫履歴

過去の入出庫履歴を確認できます。

**検索フィルター:**
- **履歴種別**: すべて / 出庫のみ / 入庫のみ
- **部署**: 部署で絞り込み
- **期間**: 開始日〜終了日で絞り込み
- **キーワード**: 品名または担当者名で検索

**表示項目:**
- 種別（入庫/出庫）
- 日時
- コード
- 品名
- 数量
- 担当者
- 部署
- 単価
- 合計金額
- 備考

---

## 注文管理

### 注文依頼

欠品や在庫不足の商品を発注するための依頼を作成します。

**操作手順:**
1. 「🛒 発注」タブをクリック
2. 「📋 依頼管理」サブタブで依頼を確認
3. 新規依頼する場合：
   - 在庫一覧から商品の「🛒 注文依頼」ボタンをクリック
   - または直接QRコード/品名で検索
4. 以下を入力：
   - 数量（必須）
   - 納期（必須、例: 「最短」「2週間」など）
   - 社員コード（入力すると氏名・部署が自動入力）
   - 依頼者名（必須）
   - 部署（任意）
   - 備考（任意）
5. 「発注依頼を送信」ボタンをクリック

**依頼後の処理:**
- 商品の注文状態が「依頼中」に更新
- 依頼管理画面に表示される
- 発注担当者が注文書を作成できる状態になる

---

## 発注管理

### 🛒 発注タブ

発注タブには3つのサブタブがあります：
1. **📋 依頼管理**: 発注依頼の確認・却下
2. **📝 注文書作成**: 注文書の作成
3. **📧 注文書送信**: 注文書の送信

---

### 📋 依頼管理

発注依頼を確認し、注文書作成または却下を行います。

**操作手順:**
1. 「📋 依頼管理」サブタブをクリック
2. 依頼一覧が表示される
3. 各依頼の詳細を確認：
   - 商品コード
   - 商品名
   - 依頼数量
   - 納期
   - 依頼者
   - 依頼日
   - 状態
4. アクション：
   - **「注文書へ追加」**: 注文書作成画面に追加
   - **「却下」**: 依頼を却下（商品の注文状態が「却下」に更新）

**却下時の処理:**
- 依頼が却下状態になる
- 商品の注文状態が「却下」に更新
- 他の有効な注文がない場合、注文状態が「未依頼」に戻る

---

### 📝 注文書作成

複数の依頼をまとめて注文書を作成します。

**操作手順:**
1. 「📝 注文書作成」サブタブをクリック
2. 追加された商品一覧が表示される
3. 購入先を選択（必須）
4. 納期を入力（日付選択、デフォルト: 「最短」）
5. 備考を入力（任意）
6. 各商品の数量を確認・修正
7. 不要な商品は「削除」ボタンで削除
8. 「注文書を作成」ボタンをクリック

**注文書作成後の処理:**
- 注文書がPDFで生成される
- 注文書番号が自動採番される（形式: PO-YYYYMMDD-XXX）
- 商品の注文状態が「発注準備」に更新
- 注文書送信画面に表示される

---

### 📧 注文書送信

作成した注文書を購入先にメール送信します。

**操作手順:**
1. 「📧 注文書送信」サブタブをクリック
2. 作成済みの注文書一覧が表示される
3. 各注文書の詳細を確認：
   - 注文書番号
   - 購入先
   - 品目数
   - 合計金額
   - 作成日
   - 状態
4. 送信する注文書の「📧 送信」ボタンをクリック
5. 確認ダイアログで「OK」をクリック

**送信後の処理:**
- 注文書PDFが購入先のメールアドレスに送信される
- 注文書のステータスが「送信済」に更新
- 商品の注文状態が「発注済」に更新
- ordersテーブルのステータスが「発注済」に更新

**注文書の削除:**
- 未送信の注文書のみ削除可能
- 「🗑️ 削除」ボタンをクリック
- 確認ダイアログで「OK」をクリック

---

## マスタ管理

### 消耗品管理

消耗品マスタの登録・編集を行います。

#### 新規登録

**操作手順:**
1. 「消耗品管理」タブをクリック
2. 「新規登録」サブタブを選択
3. 以下を入力：
   - **商品名**（必須）
   - **コード**（必須、QRコード用）
   - **発注コード**（任意、購入先用のコード）
   - **カテゴリ**（必須）
   - **単位**（必須、例: 個、本、箱）
   - **単価**（任意）
   - **安全在庫**（必須）
   - **購入先**（必須）
   - **画像**（任意、最大5MB）
4. 「登録」ボタンをクリック

**画像アップロード:**
- 「画像を選択」ボタンで画像ファイルを選択
- プレビューが表示される
- 「クリア」ボタンで選択を解除

#### 個別編集

**操作手順:**
1. 「個別編集」サブタブを選択
2. ギャラリーから編集する商品をクリック
3. 商品情報が入力欄に表示される
4. 必要な項目を修正
5. 「更新」ボタンをクリック

---

### 購入先管理

購入先マスタの登録・編集を行います。

#### 新規追加

**操作手順:**
1. 「購入先管理」タブをクリック
2. 「➕ 新規追加」サブタブを選択
3. 以下を入力：
   - **購入先名**（必須）
   - **担当者名**（任意）
   - **電話番号**（任意）
   - **メールアドレス**（任意、注文書送信先）
   - **住所**（任意）
4. 「登録」ボタンをクリック

#### 編集

**操作手順:**
1. 「📋 購入先一覧」サブタブで購入先を確認
2. 「✏️ 編集」サブタブを選択
3. 編集する購入先を選択
4. 情報を修正
5. 「更新」ボタンをクリック

---

### 従業員管理

従業員マスタの登録・編集を行います。

#### 新規登録

**操作手順:**
1. 「👤 従業員管理」タブをクリック
2. 「⭐ 新規登録」サブタブを選択
3. 以下を入力：
   - **社員コード**（必須、一意）
   - **氏名**（必須）
   - **部署**（任意）
4. 「登録」ボタンをクリック

**社員コードの活用:**
- 入出庫時に社員コードを入力すると、氏名・部署が自動入力される
- 作業効率が向上する

#### 編集

**操作手順:**
1. 「👤 従業員一覧」サブタブで従業員を確認
2. 「編集」サブタブを選択
3. 編集する従業員を選択
4. 情報を修正
5. 「更新」ボタンをクリック

---

### ユーザー管理

システムユーザーの登録・編集・権限管理を行います。

#### 新規登録

**操作手順:**
1. 「👥 ユーザー管理」タブをクリック
2. 「➕ 新規登録」サブタブを選択
3. 以下を入力：
   - **ログインID**（必須、一意）
   - **パスワード**（必須）
   - **氏名**（必須）
   - **メールアドレス**（任意）
   - **ロール**（必須）
4. 「登録」ボタンをクリック

#### ロール管理

**利用可能なロール:**
- **管理者**: 全機能へのアクセス権限
- **発注担当**: 発注関連機能へのアクセス権限
- **一般ユーザー**: 在庫閲覧・入出庫のみ

**操作手順:**
1. 「📋 ロール管理」サブタブを選択
2. ロールの一覧・説明を確認
3. 新規ユーザー登録時に適切なロールを選択

#### 権限設定

**操作手順:**
1. 「🔧 権限設定」サブタブを選択
2. ユーザーを選択
3. 権限を変更
4. 「保存」ボタンをクリック

---

## よくある質問

### Q1: QRコードが読み取れない
**A:** 以下を確認してください：
- カメラの権限が許可されているか
- QRコードが明瞭に印刷されているか
- 照明が十分か
- カメラのピントが合っているか

### Q2: 在庫数が合わない
**A:** 以下を確認してください：
- 入出庫履歴を確認し、記録漏れがないか
- 注文書分入庫で重複入庫していないか
- 手動で在庫数を修正した履歴がないか

### Q3: 注文書が送信できない
**A:** 以下を確認してください：
- 購入先のメールアドレスが登録されているか
- インターネット接続が正常か
- メールサーバーの設定が正しいか（管理者に確認）

### Q4: 注文書分入庫を間違って実行してしまった
**A:** 以下の対処方法があります：
1. **入出庫履歴を確認**: どの商品が入庫されたか確認
2. **手動で在庫を修正**: 各商品の在庫数を手動で減らす
3. **管理者に連絡**: データベースから直接修正が必要な場合

### Q5: パスワードを忘れた
**A:** 管理者に連絡して、パスワードリセットを依頼してください。

### Q6: 商品画像が表示されない
**A:** 以下を確認してください：
- 画像ファイルのサイズが5MB以下か
- 画像形式がJPG、PNG、GIFか
- ブラウザのキャッシュをクリアする

### Q7: 注文書のPDFが生成されない
**A:** 管理者に連絡してください。サーバーの設定が必要な場合があります。

### Q8: 在庫一覧の読み込みが遅い
**A:** 以下を試してください：
- フィルターで絞り込む
- ブラウザのキャッシュをクリアする
- ブラウザを再起動する

---

## トラブルシューティング

### エラーメッセージ一覧

#### 「必須パラメータが不足しています」
- 必須項目が未入力です
- すべての必須項目を入力してください

#### 「商品が見つかりません」
- 指定したコードの商品が存在しません
- コードを確認してください

#### 「在庫が不足しています」
- 出庫数量が在庫数を超えています
- 数量を減らすか、入庫してください

#### 「権限がありません」
- この機能へのアクセス権限がありません
- 管理者に権限付与を依頼してください

---

## サポート

### お問い合わせ
システムに関するお問い合わせは、システム管理者までご連絡ください。

### バグ報告
バグを発見した場合は、以下の情報とともに管理者に報告してください：
- 発生した操作
- エラーメッセージ
- 発生日時
- ブラウザの種類・バージョン

---

## 付録

### ショートカットキー
- **検索欄にフォーカス**: Ctrl + F
- **リロード**: F5 または Ctrl + R

### データバックアップ
システム管理者が定期的にデータベースのバックアップを実施しています。

---

**マニュアル作成日**: 2025-11-15
**作成者**: Claude Code
**バージョン**: 1.0
